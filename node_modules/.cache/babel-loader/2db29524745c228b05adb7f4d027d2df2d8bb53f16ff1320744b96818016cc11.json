{"ast":null,"code":"import{useLocation}from'react-router-dom';import{useNavigate,useParams}from'react-router-dom';import{useState,useMemo}from'react';import{Container,Form,Button}from'react-bootstrap';import MovieDataService from'../services/movies';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AddReview=_ref=>{let{user}=_ref;const navigate=useNavigate();let params=useParams();let location=useLocation();// Hooks 必须在顶层调用\nconst editing=useMemo(()=>location.state&&location.state.currentReview?true:false,[location.state]);const initialReviewState=useMemo(()=>editing?location.state.currentReview.review:\"\",[editing,location.state]);const[review,setReview]=useState(initialReviewState);if(!user){return/*#__PURE__*/_jsx(\"div\",{children:\"Please log in to add or edit a review.\"});}const onChangeReview=e=>{const review=e.target.value;setReview(review);};const saveReview=()=>{var data={review:review,name:user.name,user_id:user.googleId,movie_id:params.id};if(editing){data.review_id=location.state.currentReview._id;MovieDataService.updateReview(data).then(response=>{navigate(\"/movies/\"+params.id);}).catch(e=>{console.log(e);});}else{MovieDataService.createReview(data).then(response=>{navigate(\"/movies/\"+params.id);}).catch(e=>{console.log(e);});}};return/*#__PURE__*/_jsx(Container,{className:\"main-container\",children:/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(Form.Label,{children:[editing?\"Edit\":\"Create\",\" Review\"]}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",type:\"text\",required:true,value:review,onChange:onChangeReview})]}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:saveReview,children:\"Submit\"})]})});};export default AddReview;","map":{"version":3,"names":["useLocation","useNavigate","useParams","useState","useMemo","Container","Form","Button","MovieDataService","jsx","_jsx","jsxs","_jsxs","AddReview","_ref","user","navigate","params","location","editing","state","currentReview","initialReviewState","review","setReview","children","onChangeReview","e","target","value","saveReview","data","name","user_id","googleId","movie_id","id","review_id","_id","updateReview","then","response","catch","console","log","createReview","className","Group","Label","Control","as","type","required","onChange","variant","onClick"],"sources":["/Users/tenmoutheshark/Desktop/mern-stack-project-backend-Tenmou-Vi/frontend/src/components/AddReview.js"],"sourcesContent":["import { useLocation } from 'react-router-dom';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { useState, useMemo } from 'react';\nimport { Container, Form, Button } from 'react-bootstrap';\nimport MovieDataService from '../services/movies';\n\nconst AddReview = ({ user }) => {\n  const navigate = useNavigate();\n  let params = useParams();\n  let location = useLocation();\n\n  // Hooks 必须在顶层调用\n  const editing = useMemo(() => location.state && location.state.currentReview ? true : false, [location.state]);\n  const initialReviewState = useMemo(() => (editing ? location.state.currentReview.review : \"\"), [editing, location.state]);\n  const [review, setReview] = useState(initialReviewState);\n\n  if (!user) {\n    return <div>Please log in to add or edit a review.</div>;\n  }\n\n  const onChangeReview = e => {\n    const review = e.target.value;\n    setReview(review);\n  };\n\n  const saveReview = () => {\n    var data = {\n      review: review,\n      name: user.name,\n      user_id: user.googleId,\n      movie_id: params.id,\n    };\n    if (editing) {\n      data.review_id = location.state.currentReview._id;\n      MovieDataService.updateReview(data)\n        .then(response => {\n          navigate(\"/movies/\" + params.id);\n        })\n        .catch(e => {\n          console.log(e);\n        });\n    } else {\n      MovieDataService.createReview(data)\n        .then(response => {\n          navigate(\"/movies/\" + params.id);\n        })\n        .catch(e => {\n          console.log(e);\n        });\n    }\n  };\n\n  return (\n    <Container className=\"main-container\">\n      <Form>\n        <Form.Group className=\"mb-3\">\n          <Form.Label>{ editing ? \"Edit\" : \"Create\" } Review</Form.Label>\n          <Form.Control\n            as=\"textarea\"\n            type=\"text\"\n            required\n            value={review}\n            onChange={onChangeReview}\n          />\n        </Form.Group>\n        <Button variant=\"primary\" onClick={saveReview}>\n          Submit\n        </Button>\n      </Form>\n    </Container>\n  );\n};\n\nexport default AddReview; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}