{"ast":null,"code":"import _objectSpread from\"/Users/tenmoutheshark/Desktop/mern-stack-project-backend-Tenmou-Vi/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from\"react\";import MovieDataService from\"../services/movies\";import{Link,useParams,useLocation}from\"react-router-dom\";import Card from\"react-bootstrap/Card\";import Container from\"react-bootstrap/Container\";import Image from\"react-bootstrap/Image\";import Col from\"react-bootstrap/Col\";import Row from\"react-bootstrap/Row\";import moment from\"moment\";import Button from'react-bootstrap/Button';import\"./Movie.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Movie=_ref=>{let{user}=_ref;const params=useParams();const location=useLocation();const[movie,setMovie]=useState({id:null,title:\"\",rated:\"\",reviews:[]});const getMovie=id=>{MovieDataService.get(id).then(response=>{setMovie(response.data);console.log(response.data);}).catch(e=>{console.log(e);});};useEffect(()=>{console.log(\"[Movie.js] useEffect triggered, params.id:\",params.id,\"location.key:\",location.key);getMovie(params.id);},[params.id,location.key]);const handleDeleteReview=(reviewId,index)=>{const data={review_id:reviewId,user_id:user.googleId};MovieDataService.deleteReview(data).then(response=>{setMovie(prevState=>{prevState.reviews.splice(index,1);return _objectSpread({},prevState);});}).catch(e=>{console.log(e);});};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"div\",{className:\"poster\",children:/*#__PURE__*/_jsx(Image,{className:\"bigPicture\",src:\"/images/custom-poster.jpg\",onError:_ref2=>{let{currentTarget}=_ref2;currentTarget.onerror=null;currentTarget.src=\"/images/custom-poster.jpg\";},fluid:true})})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Card.Header,{as:\"h5\",children:movie.title}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Text,{children:movie.plot}),user&&/*#__PURE__*/_jsx(Link,{to:\"/movies/\".concat(params.id,\"/review\"),children:\"Add Review\"}),movie.reviews&&movie.reviews.map((review,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"d-flex\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex-shrink-0 reviewsText\",children:[/*#__PURE__*/_jsxs(\"h5\",{children:[review.name+\" reviewed on \",moment(review.date).format(\"Do MMMM YYYY\")]}),/*#__PURE__*/_jsx(\"p\",{className:\"review\",children:review.review}),user&&user.googleId===review.user_id&&/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Link,{to:{pathname:\"/movies/\".concat(params.id,\"/review/\")},state:{currentReview:review},children:\"Edit\"})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Button,{variant:\"link\",onClick:()=>handleDeleteReview(review._id,index),children:\"Delete\"})})]})]})},index))]})]})})]})})});};export default Movie;","map":{"version":3,"names":["React","useState","useEffect","MovieDataService","Link","useParams","useLocation","Card","Container","Image","Col","Row","moment","Button","jsx","_jsx","jsxs","_jsxs","Movie","_ref","user","params","location","movie","setMovie","id","title","rated","reviews","getMovie","get","then","response","data","console","log","catch","e","key","handleDeleteReview","reviewId","index","review_id","user_id","googleId","deleteReview","prevState","splice","_objectSpread","children","className","src","onError","_ref2","currentTarget","onerror","fluid","Header","as","Body","Text","plot","to","concat","map","review","name","date","format","pathname","state","currentReview","variant","onClick","_id"],"sources":["/Users/tenmoutheshark/Desktop/mern-stack-project-backend-Tenmou-Vi/frontend/src/components/Movie.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport MovieDataService from \"../services/movies\";\nimport { Link, useParams, useLocation } from \"react-router-dom\";\nimport Card from \"react-bootstrap/Card\";\nimport Container from \"react-bootstrap/Container\";\nimport Image from \"react-bootstrap/Image\";\nimport Col from \"react-bootstrap/Col\";\nimport Row from \"react-bootstrap/Row\";\nimport moment from \"moment\";\nimport Button from 'react-bootstrap/Button';\n\nimport \"./Movie.css\";\n\nconst Movie = ({ user }) => {\n  const params = useParams();\n  const location = useLocation();\n\n  const [movie, setMovie] = useState({\n    id: null,\n    title: \"\",\n    rated: \"\",\n    reviews: [],\n  });\n\n  const getMovie = (id) => {\n    MovieDataService.get(id)\n      .then((response) => {\n        setMovie(response.data);\n        console.log(response.data);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  useEffect(() => {\n    console.log(\"[Movie.js] useEffect triggered, params.id:\", params.id, \"location.key:\", location.key);\n    getMovie(params.id);\n  }, [params.id, location.key]);\n\n  const handleDeleteReview = (reviewId, index) => {\n    const data = {\n      review_id: reviewId,\n      user_id: user.googleId,\n    };\n    MovieDataService.deleteReview(data)\n      .then(response => {\n        setMovie(prevState => {\n          prevState.reviews.splice(index, 1);\n          return { ...prevState };\n        });\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  };\n\n  return (\n    <div>\n      <Container>\n        <Row>\n          <Col>\n            <div className=\"poster\">\n              <Image\n                className=\"bigPicture\"\n                src=\"/images/custom-poster.jpg\"\n                onError={({ currentTarget }) => {\n                  currentTarget.onerror = null;\n                  currentTarget.src = \"/images/custom-poster.jpg\";\n                }}\n                fluid\n              />\n            </div>\n          </Col>\n          <Col>\n            <Card>\n              <Card.Header as=\"h5\">{movie.title}</Card.Header>\n              <Card.Body>\n                <Card.Text>{movie.plot}</Card.Text>\n                {user && (\n                  <Link to={`/movies/${params.id}/review`}>\n                    Add Review\n                  </Link>\n                )}\n                {movie.reviews && movie.reviews.map((review, index) => (\n                  <div className=\"d-flex\" key={index}>\n                    <div className=\"flex-shrink-0 reviewsText\">\n                      <h5>{review.name + \" reviewed on \"}{moment(review.date).format(\"Do MMMM YYYY\")}</h5>\n                      <p className=\"review\">{review.review}</p>\n                      {user && user.googleId === review.user_id && (\n                        <Row>\n                          <Col>\n                            <Link\n                              to={{\n                                pathname: `/movies/${params.id}/review/`,\n                              }}\n                              state={{\n                                currentReview: review,\n                              }}\n                            >\n                              Edit\n                            </Link>\n                          </Col>\n                          <Col>\n                            <Button variant=\"link\" onClick={() => handleDeleteReview(review._id, index)}>\n                              Delete\n                            </Button>\n                          </Col>\n                        </Row>\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </Card.Body>\n            </Card>\n          </Col>\n        </Row>\n      </Container>\n    </div>\n  );\n};\n\nexport default Movie; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}