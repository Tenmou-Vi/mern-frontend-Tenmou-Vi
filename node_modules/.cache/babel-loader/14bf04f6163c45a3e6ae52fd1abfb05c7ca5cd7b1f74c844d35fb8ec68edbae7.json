{"ast":null,"code":"import{useState,useEffect,useCallback,useRef}from'react';import{GoogleOAuthProvider}from'@react-oauth/google';import Login from\"./components/Login\";import Logout from\"./components/Logout\";import{Routes,Route,Link}from\"react-router-dom\";import\"bootstrap/dist/css/bootstrap.min.css\";import Container from\"react-bootstrap/Container\";import{Navbar,Nav}from\"react-bootstrap\";import MoviesList from\"./components/MoviesList\";import Movie from\"./components/Movie\";import AddReview from\"./components/AddReview\";import Favorites from\"./components/Favorites\";import'./App.css';import{getFavorites,updateFavorites}from\"./services/favorites\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const clientId=process.env.REACT_APP_GOOGLE_CLIENT_ID;function App(){const[user,setUser]=useState(null);const[favorites,setFavorites]=useState([]);const isFirstLoad=useRef(true);const loadFavorites=useCallback(async()=>{if(user&&user.googleId){try{const data=await getFavorites(user.googleId);setFavorites(data.favorites||[]);}catch(e){setFavorites([]);}}else{setFavorites([]);}},[user,setFavorites]);useEffect(()=>{loadFavorites();isFirstLoad.current=false;},[loadFavorites]);useEffect(()=>{if(!isFirstLoad.current&&user&&user.googleId){updateFavorites(user.googleId,favorites);}},[favorites,user]);useEffect(()=>{console.log(\"user\",user);},[user]);const addFavorite=movieId=>{setFavorites(prev=>[...prev,movieId]);};const deleteFavorite=movieId=>{setFavorites(prev=>prev.filter(f=>f!==movieId));};useEffect(()=>{let loginData=JSON.parse(localStorage.getItem(\"login\"));if(loginData){let loginExp=loginData.exp;let now=Date.now()/1000;if(now<loginExp){setUser(loginData);}else{localStorage.setItem(\"login\",null);}}},[]);return/*#__PURE__*/_jsx(GoogleOAuthProvider,{clientId:clientId,children:/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Navbar,{bg:\"primary\",expand:\"lg\",sticky:\"top\",variant:\"dark\",children:/*#__PURE__*/_jsxs(Container,{className:\"container-fluid\",children:[/*#__PURE__*/_jsxs(Navbar.Brand,{href:\"/\",className:\"brand\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/images/movies-logo.png\",alt:\"movies logo\",className:\"moviesLogo\",onError:e=>{console.log(\"Logo failed to load:\",e.target.src);e.target.style.display='none';},onLoad:()=>{console.log(\"Logo loaded successfully\");}}),\"MOVIE TIME\"]}),/*#__PURE__*/_jsx(Navbar.Toggle,{\"aria-controls\":\"basic-navbar-nav\"}),/*#__PURE__*/_jsxs(Navbar.Collapse,{id:\"responsive-navbar-nav\",children:[/*#__PURE__*/_jsxs(Nav,{className:\"ml-auto\",children:[/*#__PURE__*/_jsx(Nav.Link,{as:Link,to:\"/movies\",className:\"link\",children:\"Movies\"}),/*#__PURE__*/_jsx(Nav.Link,{as:Link,to:\"/favorites\",className:\"link\",children:\"Favorites\"})]}),user?/*#__PURE__*/_jsx(Logout,{setUser:setUser,clientId:clientId}):/*#__PURE__*/_jsx(Login,{setUser:setUser})]})]})}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",element:/*#__PURE__*/_jsx(MoviesList,{user:user,favorites:favorites,addFavorite:addFavorite,deleteFavorite:deleteFavorite})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/movies\",element:/*#__PURE__*/_jsx(MoviesList,{user:user,favorites:favorites,addFavorite:addFavorite,deleteFavorite:deleteFavorite})}),/*#__PURE__*/_jsx(Route,{path:\"/movies/:id\",element:/*#__PURE__*/_jsx(Movie,{user:user})}),/*#__PURE__*/_jsx(Route,{path:\"/movies/:id/review\",element:/*#__PURE__*/_jsx(AddReview,{user:user})}),/*#__PURE__*/_jsx(Route,{path:\"/favorites\",element:/*#__PURE__*/_jsx(Favorites,{user:user})})]})]})});}export default App;","map":{"version":3,"names":["useState","useEffect","useCallback","useRef","GoogleOAuthProvider","Login","Logout","Routes","Route","Link","Container","Navbar","Nav","MoviesList","Movie","AddReview","Favorites","getFavorites","updateFavorites","jsx","_jsx","jsxs","_jsxs","clientId","process","env","REACT_APP_GOOGLE_CLIENT_ID","App","user","setUser","favorites","setFavorites","isFirstLoad","loadFavorites","googleId","data","e","current","console","log","addFavorite","movieId","prev","deleteFavorite","filter","f","loginData","JSON","parse","localStorage","getItem","loginExp","exp","now","Date","setItem","children","className","bg","expand","sticky","variant","Brand","href","src","alt","onError","target","style","display","onLoad","Toggle","Collapse","id","as","to","exact","path","element"],"sources":["/Users/tenmoutheshark/Desktop/mern-stack-project-backend-Tenmou-Vi/frontend/src/App.js"],"sourcesContent":["import { useState, useEffect, useCallback, useRef } from 'react';\nimport { GoogleOAuthProvider } from '@react-oauth/google';\nimport Login from \"./components/Login\";\nimport Logout from \"./components/Logout\";\nimport { Routes, Route, Link } from \"react-router-dom\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport Container from \"react-bootstrap/Container\";\nimport { Navbar, Nav } from \"react-bootstrap\";\n\nimport MoviesList from \"./components/MoviesList\";\nimport Movie from \"./components/Movie\";\nimport AddReview from \"./components/AddReview\";\nimport Favorites from \"./components/Favorites\";\n\nimport './App.css';\nimport { getFavorites, updateFavorites } from \"./services/favorites\";\n\nconst clientId = process.env.REACT_APP_GOOGLE_CLIENT_ID;\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [favorites, setFavorites] = useState([]);\n  const isFirstLoad = useRef(true);\n\n  const loadFavorites = useCallback(async () => {\n    if (user && user.googleId) {\n      try {\n        const data = await getFavorites(user.googleId);\n        setFavorites(data.favorites || []);\n      } catch (e) {\n        setFavorites([]);\n      }\n    } else {\n      setFavorites([]);\n    }\n  }, [user, setFavorites]);\n\n  useEffect(() => {\n    loadFavorites();\n    isFirstLoad.current = false;\n  }, [loadFavorites]);\n\n  useEffect(() => {\n    if (!isFirstLoad.current && user && user.googleId) {\n      updateFavorites(user.googleId, favorites);\n    }\n  }, [favorites, user]);\n\n  useEffect(() => {\n    console.log(\"user\", user);\n  }, [user]);\n\n  const addFavorite = (movieId) => {\n    setFavorites((prev) => [...prev, movieId]);\n  };\n\n  const deleteFavorite = (movieId) => {\n    setFavorites((prev) => prev.filter((f) => f !== movieId));\n  };\n\n  useEffect(() => {\n    let loginData = JSON.parse(localStorage.getItem(\"login\"));\n    if (loginData) {\n      let loginExp = loginData.exp;\n      let now = Date.now() / 1000;\n      if (now < loginExp) {\n        setUser(loginData);\n      } else {\n        localStorage.setItem(\"login\", null);\n      }\n    }\n  }, []);\n\n  return (\n    <GoogleOAuthProvider clientId={clientId}>\n      <div className=\"App\">\n        <Navbar bg=\"primary\" expand=\"lg\" sticky=\"top\" variant=\"dark\">\n          <Container className=\"container-fluid\">\n            <Navbar.Brand href=\"/\" className=\"brand\">\n              <img \n                src=\"/images/movies-logo.png\" \n                alt=\"movies logo\" \n                className=\"moviesLogo\"\n                onError={(e) => {\n                  console.log(\"Logo failed to load:\", e.target.src);\n                  e.target.style.display = 'none';\n                }}\n                onLoad={() => {\n                  console.log(\"Logo loaded successfully\");\n                }}\n              />\n              MOVIE TIME\n            </Navbar.Brand>\n            <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n            <Navbar.Collapse id=\"responsive-navbar-nav\">\n              <Nav className=\"ml-auto\">\n                <Nav.Link as={Link} to=\"/movies\" className=\"link\">\n                  Movies\n                </Nav.Link>\n                <Nav.Link as={Link} to=\"/favorites\" className=\"link\">\n                  Favorites\n                </Nav.Link>\n              </Nav>\n              { user ? (\n                  <Logout setUser={setUser} clientId={clientId} />\n                ) : (\n                  <Login setUser={setUser} />\n              )}\n            </Navbar.Collapse>\n          </Container>\n        </Navbar>\n\n        <Routes>\n          <Route exact path={\"/\"} element={\n            <MoviesList\n              user={user}\n              favorites={favorites}\n              addFavorite={addFavorite}\n              deleteFavorite={deleteFavorite}\n            />\n          } />\n          <Route exact path={\"/movies\"} element={\n            <MoviesList\n              user={user}\n              favorites={favorites}\n              addFavorite={addFavorite}\n              deleteFavorite={deleteFavorite}\n            />\n          } />\n          <Route path={\"/movies/:id\"} element={\n            <Movie user={user} />\n          } />\n          <Route path={\"/movies/:id/review\"} element={<AddReview user={user} />} />\n          <Route path={\"/favorites\"} element={<Favorites user={user} />} />\n        </Routes>\n      </div>\n    </GoogleOAuthProvider>\n  );\n}\n\nexport default App; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}